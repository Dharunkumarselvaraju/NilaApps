<div class="chart-container">
  <h3 class="chart-title">Average Assessment Score</h3>
  
  <div class="chart-content" *ngIf="data">
    <div class="donut-container">
      <svg class="donut-chart" viewBox="0 0 120 120">
        <circle
          class="donut-background"
          cx="60"
          cy="60"
          r="45"
          fill="none"
          stroke="var(--chart-grid)"
          stroke-width="12">
        </circle>          <!-- Completed segment -->
        <circle
          class="donut-segment completed"
          cx="60"
          cy="60"
          r="45"
          fill="none"
          stroke="#10b981"
          stroke-width="12"
          stroke-linecap="round"
          [style.stroke-dasharray]="strokeDashArray"
          [style.stroke-dashoffset]="completedOffset"
          transform="rotate(-90 60 60)"
          (mouseenter)="onSegmentHover($event, 'completed')"
          (mouseleave)="onSegmentLeave()">
        </circle>
        
        <!-- Not completed segment -->
        <circle
          class="donut-segment not-completed"
          cx="60"
          cy="60"
          r="45"
          fill="none"
          stroke="#ef4444"
          stroke-width="12"
          stroke-linecap="round"
          [style.stroke-dasharray]="strokeDashArray"
          [style.stroke-dashoffset]="notCompletedOffset"
          [style.transform]="'rotate(' + rotationAngle + 'deg)'"
          (mouseenter)="onSegmentHover($event, 'notCompleted')"
          (mouseleave)="onSegmentLeave()">
        </circle><!-- Center text -->
        <text x="60" y="55" text-anchor="middle" class="center-text-main">All Districts</text>
        <text x="60" y="70" text-anchor="middle" class="center-text-sub" *ngIf="data">{{ data.completedPercent }}% Complete</text>
      </svg>
    </div>

    <!-- Legend -->
    <div class="legend">
      <div class="legend-item" *ngFor="let item of chartData">
        <div class="legend-color" [style.background-color]="item.color"></div>
        <div class="legend-info">
          <span class="legend-percentage">{{ item.value }}%</span>
          <span class="legend-label">{{ item.label }}</span>
        </div>
      </div>
    </div>
  </div>
  <div class="no-data" *ngIf="!data">
    <p>No data available</p>
  </div>

  <!-- Tooltip -->
  <div class="tooltip" 
       *ngIf="showTooltip && tooltipData"
       [style.left.px]="tooltipPosition.x"
       [style.top.px]="tooltipPosition.y">
    <div class="tooltip-header">
      <div class="tooltip-color" [style.background-color]="tooltipData.color"></div>
      <span class="tooltip-title">{{ tooltipData.type }}</span>
    </div>
    <div class="tooltip-content">
      <span class="tooltip-value">{{ tooltipData.percentage }}%</span>
    </div>
  </div>
</div>
