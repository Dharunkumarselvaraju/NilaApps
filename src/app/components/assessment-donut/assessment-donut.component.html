<div class="chart-container">
  <h3 class="chart-title">Average Assessment Score</h3>
  
  <div class="chart-content" *ngIf="data">
    <!-- Percentage labels outside donut -->
    <div class="percentage-labels">
      <div class="percentage-label not-completed-label">
        <span class="percentage-value">{{ data.notCompletedPercent }}%</span>
        <span class="percentage-text">Assessment not completed</span>
      </div>
      <div class="percentage-label completed-label">
        <span class="percentage-value">{{ data.completedPercent }}%</span>
        <span class="percentage-text">Assessment completed</span>
      </div>
    </div>
    
    <div class="donut-container">
      <svg class="donut-chart" viewBox="0 0 120 120">
        <circle
          class="donut-background"
          cx="60"
          cy="60"
          r="45"
          fill="none"
          stroke="var(--chart-grid)"
          stroke-width="12">
        </circle>
        
        <!-- Completed segment (cyan/teal) -->
        <circle
          class="donut-segment completed"
          cx="60"
          cy="60"
          r="45"
          fill="none"
          stroke="#22d3ee"
          stroke-width="12"
          [style.stroke-dasharray]="strokeDashArray"
          [style.stroke-dashoffset]="completedOffset"
          transform="rotate(-90 60 60)"
          (mouseenter)="onSegmentHover($event, 'completed')"
          (mouseleave)="onSegmentLeave()">
        </circle>
        
        <!-- Not completed segment (orange) -->
        <circle
          class="donut-segment not-completed"
          cx="60"
          cy="60"
          r="45"
          fill="none"
          stroke="#f97316"
          stroke-width="12"
          [style.stroke-dasharray]="strokeDashArray"
          [style.stroke-dashoffset]="notCompletedOffset"
          [style.transform]="'rotate(' + rotationAngle + 'deg)'"
          transform-origin="60 60"
          (mouseenter)="onSegmentHover($event, 'notCompleted')"
          (mouseleave)="onSegmentLeave()">
        </circle>
        
        <!-- Center text -->
        <text x="60" y="60" text-anchor="middle" dominant-baseline="middle" class="center-text-main">{{ centerText }}</text>
      </svg>
    </div>

  </div>
  <div class="no-data" *ngIf="!data">
    <p>No data available</p>
  </div>

  <!-- Tooltip -->
  <div class="tooltip" 
       *ngIf="showTooltip && tooltipData"
       [style.left.px]="tooltipPosition.x"
       [style.top.px]="tooltipPosition.y">
    <div class="tooltip-header">
      <div class="tooltip-color" [style.background-color]="tooltipData.color"></div>
      <span class="tooltip-title">{{ tooltipData.type }}</span>
    </div>
    <div class="tooltip-content">
      <span class="tooltip-value">{{ tooltipData.percentage }}%</span>
    </div>
  </div>
</div>
